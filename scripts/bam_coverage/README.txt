The script flagstat.py runs samtools flagstat on all bam files in a specified directory in parallel. In this script, secondary alignments (not primary alignment) are excluded using "-F 256." The script flagstat.sh runs flagstat.py as a batch job on UCSC hummingbird.

The script run_mosdepth.py runs the mosdepth program (https://github.com/brentp/mosdepth) on all bam files in a specified directory in parallel. Mosdepth estimates coverage depth and breadth metrics. And can estimate coverage by region given a regions file. The file "sorted_exons.bed" contains all protein-coding exons in the S. purpuratus reference genome assembly. The script run_mosdepth.sh runs run_mosdepth.py as a batch job on UCSC hummingbird. 

The script mrna.py uses the raw mosdepth output to calculate coverage depth metrics for a list of samples for all mRNA transcripts in the S. purpuratus reference genome assembly. Mosdepth must first be run with a regions file of all coding exons (sorted_exons.bed). mrna.py then aggregates the data from the different exons of each transcript to estimate coverage data for that transcript. This script outputs a ".regions.bed.gz" file that lists each transcript and it's mean coverage depth. It also outputs a ".thresholds.bed.gz" file that lists each transcript, it's length, and the number of bases covered by 1x, 10x, and 20x. The script mrna_array.sh runs mrna.py as a batch array job on UCSC hummingbird. 
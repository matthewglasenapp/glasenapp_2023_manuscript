The scripts in this directory use vcf2fasta (https://github.com/santiagosnchez/vcf2fasta) IQ-TREE2 and the coverage depth metrics estimated by mosdepth to create multiple sequence alignments of putative single-copy orthologs. Protein-coding gene records are filtered by coverage depth and breadth metrics. 

The script "strongylocentrotidae_slt.py" was used to create multiple sequence alignments and gene trees for species tree inference and concordance factor analysis. All nine species were included in the multiple sequence alignments. Gene records were filtered if any sample had a mean depth lower than 10x, a mean depth greater than double the sample’s mean depth for S. purpuratus exons, or fewer than 75% of the bases in the gene covered by ten reads. To account for nonindependence among loci, genes were filtered so that there was a minimum of 20kb in between included loci.

The script "franciscanus_slt.py" was used to create gene trees for PhyloNet inference. A subset of the species were used in the alignments, with M. franciscanus as the outgroup. To account for uncertainty in gene tree reconstruction, 100 bootstrap trees were inferred for each multiple sequence alignment using nonparametric bootstrap. to make 100 bootstrap trees for each locus. Gene records were filtered if any sample had a mean depth lower than 10x, a mean depth greater than double the sample’s mean depth of S. purpuratus exons, or fewer than 90% of the bases in the gene covered by ten reads. Further filtering ensured a minimum of 50kb between included genes because PhyloNet’s programs assume free recombination between loci. 